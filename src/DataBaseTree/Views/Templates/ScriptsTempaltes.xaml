<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:viewModels="clr-namespace:DBManager.Application.ViewModels"
                    xmlns:controls="clr-namespace:DBManager.Application.Controls"
                    xmlns:utils="clr-namespace:DBManager.Application.Utils">

    <ResourceDictionary.MergedDictionaries>
        <utils:SharedResourceDictionary Source="MetadataTreeTemplates.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style TargetType="TabItem"
           BasedOn="{StaticResource {x:Type TabItem}}">
        <Style.Resources>
            <DataTemplate DataType="{x:Type viewModels:ScriptViewModel}">
                <StackPanel Orientation="Horizontal"
                            Background="Transparent"
                            Margin="-4,0">
                    <Canvas Style="{StaticResource MetadataIconCanvasStyle}"
                            Background="{Binding Dialect, Converter={StaticResource DialectToIconConverter}}" />

                    <TextBlock Margin="5,0"
                               Text="{Binding Name}" />

                    <Button Command="{Binding DataContext.CloseTabCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type TabControl}}}"
                            Style="{StaticResource TabItemCloseButtonStyle}"
                            CommandParameter="{Binding}" />
                </StackPanel>
            </DataTemplate>
        </Style.Resources>
    </Style>

    <DataTemplate DataType="{x:Type viewModels:ScriptsViewModel}">
        <TabControl SelectedItem="{Binding Selected}"
                    ItemsSource="{Binding Tabs}">
            <TabControl.ContentTemplate>
                <DataTemplate DataType="{x:Type viewModels:ScriptViewModel}">
                    <controls:SqlEditor ShowLineNumbers="True"
                                        Margin="0,0,-2,-2"
                                        Background="Transparent"
                                        Foreground="{StaticResource MarkerBrush}"
                                        Sql="{Binding Sql,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                        SyntaxHighlighting="{Binding Highlighting}"
                                        VerticalScrollBarVisibility="Auto"
                                        HorizontalScrollBarVisibility="Auto" />
                </DataTemplate>
            </TabControl.ContentTemplate>
        </TabControl>

    </DataTemplate>

</ResourceDictionary>